<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>3D Heart + Love Text</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <style>
    html,body { height:100%; margin:0; overflow:hidden; background:#111; }
    #info {
      position: absolute; left: 10px; top: 10px; color: #fff;
      font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      z-index: 2; background: rgba(0,0,0,0.35); padding:8px 12px; border-radius:8px;
    }
  </style>
</head>
<body>
  <div id="info">3D Heart — Enter VR to see surprise ❤️</div>

  <script src="three.min.js"></script>
  <script type="module">
    import { VRButton } from './VRButton.js';
    import { OrbitControls } from './OrbitControls.js';
    import { FontLoader } from './FontLoader.js';
    import { TextGeometry } from './TextGeometry.js';

    const renderer = new THREE.WebGLRenderer({ antialias: true });
    renderer.setSize(window.innerWidth, window.innerHeight);
    renderer.outputEncoding = THREE.sRGBEncoding;
    renderer.xr.enabled = true;
    document.body.appendChild(renderer.domElement);
    document.body.appendChild(VRButton.createButton(renderer));

    const scene = new THREE.Scene();
    scene.background = new THREE.Color(0x0b0b0f);

    const camera = new THREE.PerspectiveCamera(70, window.innerWidth/window.innerHeight, 0.1, 100);
    camera.position.set(0, 1.6, 0);

    // Lights
    const hemi = new THREE.HemisphereLight(0xffeebb, 0x080820, 0.8);
    scene.add(hemi);
    const dir = new THREE.DirectionalLight(0xffffff, 1.0);
    dir.position.set(5, 10, 7.5);
    scene.add(dir);

    // Heart shape
    function makeHeartShape(scale=1.0) {
      const x = t => 16*Math.pow(Math.sin(t),3);
      const y = t => 13*Math.cos(t) - 5*Math.cos(2*t) - 2*Math.cos(3*t) - Math.cos(4*t);
      const shape = new THREE.Shape();
      const pts = [];
      const steps = 120;
      for (let i=0;i<=steps;i++){
        const t = i/steps * Math.PI * 2;
        pts.push(new THREE.Vector2(x(t)*scale*0.02, y(t)*scale*0.02));
      }
      shape.moveTo(pts[0].x, pts[0].y);
      for (let i=1;i<pts.length;i++) shape.lineTo(pts[i].x, pts[i].y);
      return shape;
    }

    const heartShape = makeHeartShape(1.0);
    const extrudeSettings = { depth: 0.4, bevelEnabled: true, bevelThickness: 0.05, bevelSize: 0.06, bevelSegments: 6 };
    const geometry = new THREE.ExtrudeGeometry(heartShape, extrudeSettings);
    geometry.center();

    const material = new THREE.MeshStandardMaterial({ color: 0xff3d6b, metalness: 0.2, roughness: 0.35 });
    const heart = new THREE.Mesh(geometry, material);
    const group = new THREE.Group();
    group.add(heart);
    group.position.set(0, 1.2, -3);
    scene.add(group);

    // Flying text
    let textMesh = null;
    const loader = new FontLoader();
    loader.load('https://threejs.org/examples/fonts/helvetiker_regular.typeface.json', font => {
      const textGeo = new TextGeometry("Nidhi I love you", {
        font: font, size: 0.3, height: 0.05,
        bevelEnabled: true, bevelThickness: 0.01, bevelSize: 0.02
      });
      textMesh = new THREE.Mesh(textGeo, new THREE.MeshStandardMaterial({ color: 0xff3366 }));
      textMesh.position.set(0, 1.6, -10);
      scene.add(textMesh);
    });

    // Animation
    const clock = new THREE.Clock();
    renderer.setAnimationLoop(() => {
      const t = clock.getElapsedTime();

      group.position.y = 1.2 + Math.sin(t*1.5)*0.08;
      group.rotation.y += 0.01;

      if (textMesh) {
        if (textMesh.position.z < -1.5) textMesh.position.z += 0.15;
      }

      renderer.render(scene, camera);
    });
  </script>
</body>
</html>
